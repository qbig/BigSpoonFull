{% extends "base_nav.html" %}

{% load staticfiles %}
{% load compress %}

{% block content %}

    {% for meal in meal_cards %}
    <div class="item">
        {% if meal.wait_time.0 > meal.table.outlet.treshold %}
        <span class="urgent time"><i class="icon-time"></i> waited {{meal.wait_time.0}} mins {{meal.wait_time.1}} seconds</span>
        {% else %}
        <span class="early time"><i class="icon-time"></i> waited {{meal.wait_time.0}} mins {{meal.wait_time.1}} seconds</span>
        {% endif %}
        <a href="/staff/user/{{meal.diner.id}}" rel="facebox"><img src="{{meal.diner.avatar_url}}" /></a>
        <h3>{{ meal.table.name }}</h3>
        <h4>{{ meal.diner.get_full_name }}</h4>

        <!-- Left color coded timing, list of orders, acknowledge button -->
        <ul class="order">
            {% for order in meal.orders.all %}
            <li>{{order.dish.name}}  <em>{{order.quantity}}</em></li>
            {% endfor %}
        </ul>

        {% if meal.status == 0 %}
            <a class="acknowledge"><i class="icon-check-sign"></i> Acknowledge</a>
        {% else %}
            <a class="closebill"><i class="icon-money"></i> Close Bill</a>
        {% endif %}
    </div>
    {% endfor %}
    {% for request in requests_cards %}
    <div class="item">
        {% if request.wait_time.0 > meal.table.outlet.treshold %}
        <span class="urgent time"><i class="icon-time"></i> waited {{request.wait_time.0}} mins {{request.wait_time.1}} seconds</span>
        {% else %}
        <span class="early time"><i class="icon-time"></i> waited {{request.wait_time.0}} mins {{request.wait_time.1}} seconds</span>
        {% endif %}
        <a href="/staff/user/{{request.diner.id}}" rel="facebox"><img src="{{request.diner.avatar_url}}" /></a>
        <h3>{{ request.table.name }}</h3>
        <h4>{{ request.diner.get_full_name }}</h4>
        <a class="acknowledge"><i class="icon-check-sign"></i> Acknowledge</a>
    </div>
    {% endfor %}
{% endblock content %}
